<!DOCTYPE html>
<html>
<head>
    <title>API</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f9f9f9;
        }

        h2 { text-align: center; color: #333; }

        
        #formSection {
            margin-bottom: 30px;
            padding: 20px; /* Increased padding for better separation */
            background: #fff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            border-radius: 8px;
        }

        #formSection h3 { margin-top: 0; }

        /* --- UPDATED FORM STYLES --- */
    

        #addForm input[type="text"], #addForm select, #addForm button {
            /* Apply full width to elements to force them onto separate lines */
            width: 100%;
            margin-bottom: 10px; /* Added margin for vertical separation */
            display: block; /* Ensure elements take up the full width */
            padding: 10px;
            font-size: 16px; /* Increased font size for better readability */
            box-sizing: border-box; /* Include padding/border in the element's total width */
        }

        #addForm button {
            /* Reset button padding to be vertical-friendly */
            padding: 10px 12px; 
            margin-top: 5px; /* Extra space above the button */
            background: #28a745;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }

        #addForm button:hover { background: #218838; }
        /* -------------------------- */

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: #fff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px 15px;
            text-align: left;
            position: relative;
        }

        th {
            background: #007bff;
            color: white;
            font-weight: bold;
        }

        tr:nth-child(even) { background: #f2f2f2; }
        tr:hover { background: #e0e0e0; }

        .header-filter {
            display: flex;
            justify-content: space-between;
            align-items:center;
        }

        .header-filter span { font-size: 12px; }

        .dropdown-toggle {
            background: #0056b3;
            border: none;
            color: white;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            top: 100%;
            right: 5px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-width: 100px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            z-index: 100;
        }

        .dropdown-menu button {
            width: 100%;
            padding: 6px 10px;
            border: none;
            background: white;
            text-align: left;
            cursor: pointer;
        }

        .dropdown-menu button:hover { background: #f0f0f0; }

        .pagination {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .pagination button {
            padding: 8px 14px;
            border: none;
            background: #007bff;
            color: white;
            cursor: pointer;
            border-radius: 4px;
            transition: background 0.3s;
        }

        .pagination button:hover { background: #0056b3; }
        .pagination button:disabled { background: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>

<h2>data Table</h2>


<div id="formSection">
    <h3>Add New <data></data></h3>
    <form id="addForm">
        <input type="text" id="newTitle" placeholder="Enter title" required>
        <select id="newStatus">
            <option value="pending">Pending</option>
            <option value="completed">Completed</option>
        </select>
        <button type="submit">Add</button>
    </form>
</div>


<table id="dataTable">
    <thead>
        <tr>
            <th>ID</th>
            <th>Title</th>
            <th>
                <div class="header-filter">
                    <span id="currentFilter">All</span>
                    <button class="dropdown-toggle" id="filterToggle">â–¼</button>
                    <div class="dropdown-menu" id="filterMenu">
                        <button data-filter="all">All</button>
                        <button data-filter="completed">Completed</button>
                        <button data-filter="pending">Pending</button>
                    </div>
                </div>
            </th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<div class="pagination">
    <button id="prevBtn">&lt; Previous</button>
    <button id="nextBtn">Next &gt;</button>
</div>

<script>
let data = [];
let filteredData = [];
let currentPage = 1;
const rowsPerPage = 10;


async function loadData() {
    const res = await fetch("https://jsonplaceholder.typicode.com/todos");
    data = await res.json();
    filteredData = [...data];
    showTable();
    updateButtons();
}


function showTable() {
    const tbody = document.querySelector("#dataTable tbody");
    tbody.innerHTML = "";

    const start = (currentPage - 1) * rowsPerPage;
    const end = start + rowsPerPage;
    const pageData = filteredData.slice(start, end);

    pageData.forEach(item => {
        tbody.innerHTML += `
            <tr>
                <td>${item.id}</td>
                <td>${item.title}</td>
                <td>${item.completed ? " Completed" : " Pending"}</td>
            </tr>
        `;
    });
}


function updateButtons() {
    const totalPages = Math.ceil(filteredData.length / rowsPerPage);
    document.getElementById("prevBtn").disabled = currentPage === 1;
    document.getElementById("nextBtn").disabled = currentPage === totalPages;
}


document.getElementById("nextBtn").addEventListener("click", () => {
    const totalPages = Math.ceil(filteredData.length / rowsPerPage);
    if (currentPage < totalPages) { currentPage++; showTable(); updateButtons(); }
});

document.getElementById("prevBtn").addEventListener("click", () => {
    if (currentPage > 1) { currentPage--; showTable(); updateButtons(); }
});


const filterToggle = document.getElementById("filterToggle");
const filterMenu = document.getElementById("filterMenu");
const currentFilter = document.getElementById("currentFilter");

filterToggle.addEventListener("click", () => {
    filterMenu.style.display = filterMenu.style.display === "block" ? "none" : "block";
});

filterMenu.querySelectorAll("button").forEach(btn => {
    btn.addEventListener("click", () => {
        const filter = btn.dataset.filter;
        currentFilter.textContent = btn.textContent;

        if (filter === "all") filteredData = [...data];
        else if (filter === "completed") filteredData = data.filter(item => item.completed);
        else filteredData = data.filter(item => !item.completed);

        currentPage = 1;
        showTable();
        updateButtons();
        filterMenu.style.display = "none";
    });
});


document.addEventListener("click", (e) => {
    if (!filterToggle.contains(e.target) && !filterMenu.contains(e.target)) {
        filterMenu.style.display = "none";
    }
});

document.getElementById("addForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const title = document.getElementById("newTitle").value;
    const completed = document.getElementById("newStatus").value === "completed";

    // Simulates a POST request to the API
    const res = await fetch("https://jsonplaceholder.typicode.com/todos", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ title, completed })
    });
    const newTodo = await res.json();

    // Locally adds the new item to the data array
    // Note: The ID from the mock API is often 201, but we use data.length + 1 for simple local display logic.
    newTodo.id = data.length + 1;
    data.unshift(newTodo);

    // Determines if the new item should be visible in the current filter/page
    const currentFilterValue = currentFilter.textContent.toLowerCase();
    if (currentFilterValue === "all" ||
        (currentFilterValue === "completed" && newTodo.completed) ||
        (currentFilterValue === "pending" && !newTodo.completed)) {
        filteredData.unshift(newTodo);
    }

    
    currentPage = 1;
    showTable();
    updateButtons();
    document.getElementById("addForm").reset();
});

loadData(); 
</script>

</body>
</html>